language: go

addons:
  artifacts:
    paths:
      - $GOPATH/bin/bifrost
    debug: true

go:
  - '1.10'

install:
  - mkdir $GOPATH/tmp
  - cp -Rf ./* $GOPATH/tmp && rm -Rf $GOPATH/src/DigitalBitsOrg
  - mkdir -p $GOPATH/src/github.com/digitalbitsorg/go
  - cp -Rf $GOPATH/tmp/* $GOPATH/src/github.com/digitalbitsorg/go && rm -Rf $GOPATH/tmp
  - cd $GOPATH/src/github.com/digitalbitsorg/go
  - echo $PWD
  - ls -lah
  - curl https://glide.sh/get | sh
  - glide install

script:
  - go install github.com/digitalbitsorg/go/services/bifrost
  - chmod +x $GOPATH/bin/bifrost
  - ls -lah $GOPATH/bin

matrix:
  fast_finish: true

deploy:
  provider: script
  skip_cleanup: true
  script: ./deploy.sh 2>&1
  on:
    branch: OS-15